import{a as C,b as W}from"./chunk-4BRSYC5F.js";import{a as Y,b as x}from"./chunk-XCAWGVDK.js";import{h as R,w as B}from"./chunk-WDYG26PG.js";import{$ as E,Ca as D,G as I,H as P,Ka as g,L as M,La as d,Ma as v,Ob as w,Q as m,Qb as b,Rb as k,S as _,Sb as y,Ta as A,Ub as V,X as O,ab as j,db as G,m as F,r as L,z as S}from"./chunk-LC2BMWWT.js";import{a as T,d as e,e as a,f as l}from"./chunk-HPEDZGUO.js";var h=(()=>{var o,r,s;let i=class extends V{constructor(){super(...arguments);a(this,o,void 0);a(this,r,void 0);a(this,s,void 0);l(this,o,m(B)),l(this,r,m(w)),this.getArticle=this.effect(P(t=>{this.patchState({username:t.username,articleType:t.articleType,currentOffset:t.offset}),e(this,r).scrollToPosition([0,0]),e(this,s).call(this)})),l(this,s,this.effect(I(()=>{let t=this.selectors.articleType()===C.MyArticle?{author:this.selectors.username()}:{favorited:this.selectors.username()};return e(this,o).getArticleGlobal(T({offset:this.selectors.currentOffset(),limit:i.PAGE_LIMIT},t)).pipe(y(n=>{this.patchState({articleCount:n.articlesCount,articleList:n.articles})},n=>{console.error("Get Article Failed",n)}))}))),this.toggleFavorite=this.effect(S(t=>L(()=>t.favorited?e(this,o).unfavoriteArticle(t.slug):e(this,o).favoriteArticle(t.slug)).pipe(y(()=>{e(this,s).call(this)},n=>{console.error("Toggle Favorite Failed",n)}))))}ngrxOnStoreInit(){this.setState({articleCount:0,articleList:[],articleType:C.MyArticle,currentOffset:0,username:""})}},f=i;return o=new WeakMap,r=new WeakMap,s=new WeakMap,(()=>{i.PAGE_LIMIT=5})(),(()=>{i.\u0275fac=function(){let t;return function(c){return(t||(t=E(i)))(c||i)}}()})(),(()=>{i.\u0275prov=M({token:i,factory:i.\u0275fac})})(),f})();var J=(()=>{var o,r,s,i;let p=class{constructor(){a(this,o,void 0);a(this,r,void 0);a(this,s,void 0);a(this,i,void 0);l(this,o,m(R)),l(this,r,m(h)),l(this,s,W()),l(this,i,b(e(this,o).parent.params.pipe(F(t=>t.username)))),this.articleList=e(this,r).selectors.articleList,this.articleCount=e(this,r).selectors.articleCount,this.currentOffset=e(this,r).selectors.currentOffset,this.pageLimit=O(h.PAGE_LIMIT).asReadonly()}ngOnInit(){console.log("init",e(this,s)),this.loadArticle(0)}loadArticle(t){e(this,r).getArticle({articleType:e(this,s),offset:t,username:e(this,i).call(this)})}toggleFavorite(t){e(this,r).toggleFavorite(t)}},f=p;return o=new WeakMap,r=new WeakMap,s=new WeakMap,i=new WeakMap,(()=>{p.\u0275fac=function(n){return new(n||p)}})(),(()=>{p.\u0275cmp=_({type:p,selectors:[["app-profile-article-list"]],standalone:!0,features:[j([k(h)]),G],decls:2,vars:4,consts:[[3,"articleList","toggleFavorite"],[3,"totalCount","offset","limit","offsetChange"]],template:function(n,c){n&1&&(d(0,"app-article-list",0),A("toggleFavorite",function(u){return c.toggleFavorite(u)}),v(),d(1,"app-pagination",1),A("offsetChange",function(u){return c.loadArticle(u)}),v()),n&2&&(g("articleList",c.articleList),D(1),g("totalCount",c.articleCount)("offset",c.currentOffset)("limit",c.pageLimit))},dependencies:[x,Y],changeDetection:0})})(),f})(),ut=J;export{ut as default};
